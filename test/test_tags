#!/bin/bash

. "${BASH_SOURCE%/*}/funcs.sh"

get_metadata() {
    mutagen-inspect "$1" | fgrep = | sort | sed -r 's/^\?too=Lavf.*/?too=/'
}

get_metadata "$DIRNAME/raven.mp4" > xxx

cmp -s - <(get_metadata "$DIRNAME/obama.mp4")<<END
?ART=Barack Obama
?alb=US State of the Union 2011
?cpy=Public Domain
?day=2011-01-25
?gen=Spoken
?nam=The Internet [excerpt]
?too=
trkn=(1, 0)
END

cmp -s - <(get_metadata "$DIRNAME/raven.mp4") <<END
?ART=Edgar Allen Poe
?alb=The Raven
?cmt=www.librivox.org
?day=2007
?gen=Speech
?nam=the_raven
?too=
trkn=(1, 0)
END

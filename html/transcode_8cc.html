<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FFmpegfs Fuse Multi Media Filesystem: src/transcode.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FFmpegfs Fuse Multi Media Filesystem
   &#160;<span id="projectnumber">1.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">transcode.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>File transcoder interface implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="transcode_8h_source.html">transcode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ffmpegfs_8h_source.html">ffmpegfs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ffmpeg__transcoder_8h_source.html">ffmpeg_transcoder.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buffer_8h_source.html">buffer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cache_8h_source.html">cache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logging_8h_source.html">logging.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cache__entry_8h_source.html">cache_entry.h</a>&quot;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for transcode.cc:</div>
<div class="dyncontent">
<div class="center"><img src="transcode_8cc__incl.png" border="0" usemap="#src_2transcode_8cc" alt=""/></div>
<map name="src_2transcode_8cc" id="src_2transcode_8cc">
<area shape="rect" id="node2" href="transcode_8h.html" title="File transcoder interface (for use with by FUSE) " alt="" coords="440,80,531,107"/>
<area shape="rect" id="node3" href="ffmpegfs_8h.html" title="Main include for FFmpegfs project. " alt="" coords="161,155,245,181"/>
<area shape="rect" id="node14" href="ffmpeg__transcoder_8h.html" title="FFmpeg transcoder. " alt="" coords="555,80,696,107"/>
<area shape="rect" id="node19" href="buffer_8h.html" title="Buffer class. " alt="" coords="712,229,779,256"/>
<area shape="rect" id="node22" href="cache_8h.html" title="Data cache management. " alt="" coords="890,155,958,181"/>
<area shape="rect" id="node25" href="logging_8h.html" title="Provide various log facilities to stderr, disk or syslog. " alt="" coords="995,80,1069,107"/>
<area shape="rect" id="node29" href="cache__entry_8h.html" title="Cache entry " alt="" coords="783,80,887,107"/>
<area shape="rect" id="node12" href="fileio_8h.html" title="FileIO class. " alt="" coords="582,304,642,331"/>
<area shape="rect" id="node6" href="ffmpeg__utils_8h.html" title="Various FFmpegfs utility functions. " alt="" coords="268,229,372,256"/>
<area shape="rect" id="node7" href="ffmpeg__compat_8h.html" title="FFmpeg API compatibility. " alt="" coords="5,304,128,331"/>
<area shape="rect" id="node15" href="ffmpeg__base_8h.html" title="FFmpeg transcoder base. " alt="" coords="269,155,377,181"/>
<area shape="rect" id="node16" href="id3v1tag_8h.html" title="ID3v1 tag structure " alt="" coords="783,155,865,181"/>
<area shape="rect" id="node17" href="ffmpeg__profiles_8h.html" title="FFmpeg encoder profiles. " alt="" coords="401,155,524,181"/>
</map>
</div>
</div>
<p><a href="transcode_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTHREAD__DATA.html">THREAD_DATA</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structTHREAD__DATA.html" title="THREAD_DATA struct to pass data from parent to child thread. ">THREAD_DATA</a> struct to pass data from parent to child thread.  <a href="structTHREAD__DATA.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a9464cc133b84bbc6f0dd5891aeea7981"><td class="memItemLeft" align="right" valign="top"><a id="a9464cc133b84bbc6f0dd5891aeea7981"></a>
typedef struct <a class="el" href="structTHREAD__DATA.html">THREAD_DATA</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a9464cc133b84bbc6f0dd5891aeea7981">THREAD_DATA</a></td></tr>
<tr class="memdesc:a9464cc133b84bbc6f0dd5891aeea7981"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structTHREAD__DATA.html" title="THREAD_DATA struct to pass data from parent to child thread. ">THREAD_DATA</a> struct to pass data from parent to child thread. <br /></td></tr>
<tr class="separator:a9464cc133b84bbc6f0dd5891aeea7981"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1a7bc5add7ffb809dc77dc18427c34c2"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a1a7bc5add7ffb809dc77dc18427c34c2">transcoder_thread</a> (void *arg)</td></tr>
<tr class="memdesc:a1a7bc5add7ffb809dc77dc18427c34c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transcoding thread.  <a href="#a1a7bc5add7ffb809dc77dc18427c34c2">More...</a><br /></td></tr>
<tr class="separator:a1a7bc5add7ffb809dc77dc18427c34c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf3471620b6ae9269795e339cf68243"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aeaf3471620b6ae9269795e339cf68243">transcode_until</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, size_t offset, size_t len)</td></tr>
<tr class="memdesc:aeaf3471620b6ae9269795e339cf68243"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transcode the buffer until the buffer has enough or until an error occurs. The buffer needs at least 'end' bytes before transcoding stops. Returns true if no errors and false otherwise.  <a href="#aeaf3471620b6ae9269795e339cf68243">More...</a><br /></td></tr>
<tr class="separator:aeaf3471620b6ae9269795e339cf68243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33f5c5e32ae960358957e09353f15236"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a33f5c5e32ae960358957e09353f15236">transcode_finish</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, <a class="el" href="classFFmpeg__Transcoder.html">FFmpeg_Transcoder</a> *transcoder)</td></tr>
<tr class="memdesc:a33f5c5e32ae960358957e09353f15236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the input file and free everything but the initial buffer.  <a href="#a33f5c5e32ae960358957e09353f15236">More...</a><br /></td></tr>
<tr class="separator:a33f5c5e32ae960358957e09353f15236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac10788fe59c0d275e077c89d7af43b3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#ac10788fe59c0d275e077c89d7af43b3e">transcoder_cache_path</a> (std::string &amp;path)</td></tr>
<tr class="memdesc:ac10788fe59c0d275e077c89d7af43b3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get transcoder cache path.  <a href="#ac10788fe59c0d275e077c89d7af43b3e">More...</a><br /></td></tr>
<tr class="separator:ac10788fe59c0d275e077c89d7af43b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa46f3dfbc96faf285238b7804e0525a6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aa46f3dfbc96faf285238b7804e0525a6">transcoder_init</a> (void)</td></tr>
<tr class="memdesc:aa46f3dfbc96faf285238b7804e0525a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise transcoder, create cache.  <a href="#aa46f3dfbc96faf285238b7804e0525a6">More...</a><br /></td></tr>
<tr class="separator:aa46f3dfbc96faf285238b7804e0525a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1725ef26aec277d5fdf686e231f07a8b"><td class="memItemLeft" align="right" valign="top"><a id="a1725ef26aec277d5fdf686e231f07a8b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a1725ef26aec277d5fdf686e231f07a8b">transcoder_free</a> (void)</td></tr>
<tr class="memdesc:a1725ef26aec277d5fdf686e231f07a8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free transcoder. <br /></td></tr>
<tr class="separator:a1725ef26aec277d5fdf686e231f07a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf746244e3f08933d0c1ed855915207"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aeaf746244e3f08933d0c1ed855915207">transcoder_cached_filesize</a> (<a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile, struct stat *stbuf)</td></tr>
<tr class="memdesc:aeaf746244e3f08933d0c1ed855915207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simply get encoded file size (do not create the whole encoder/decoder objects)  <a href="#aeaf746244e3f08933d0c1ed855915207">More...</a><br /></td></tr>
<tr class="separator:aeaf746244e3f08933d0c1ed855915207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d7c75585d5efc898826b2f3bf9bc4b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#ab5d7c75585d5efc898826b2f3bf9bc4b">transcoder_set_filesize</a> (<a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile, int64_t duration, <a class="el" href="ffmpeg__utils_8h.html#a17468d10f0c67a4ee7b38aab09d9e096">BITRATE</a> audio_bit_rate, int channels, int sample_rate, <a class="el" href="ffmpeg__utils_8h.html#a17468d10f0c67a4ee7b38aab09d9e096">BITRATE</a> video_bit_rate, int width, int height, int interleaved, const AVRational &amp;framerate)</td></tr>
<tr class="separator:ab5d7c75585d5efc898826b2f3bf9bc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318fb7fd8dac4f1ab7b350972962b89f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a318fb7fd8dac4f1ab7b350972962b89f">transcoder_predict_filesize</a> (<a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile, <a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry)</td></tr>
<tr class="memdesc:a318fb7fd8dac4f1ab7b350972962b89f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict file size.  <a href="#a318fb7fd8dac4f1ab7b350972962b89f">More...</a><br /></td></tr>
<tr class="separator:a318fb7fd8dac4f1ab7b350972962b89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace38421aa8da8b23852109db4b0f1c95"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#ace38421aa8da8b23852109db4b0f1c95">transcoder_new</a> (<a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile, bool begin_transcode)</td></tr>
<tr class="memdesc:ace38421aa8da8b23852109db4b0f1c95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialise the transcoder.  <a href="#ace38421aa8da8b23852109db4b0f1c95">More...</a><br /></td></tr>
<tr class="separator:ace38421aa8da8b23852109db4b0f1c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa956e0359fdd915fdae612651e7a806d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aa956e0359fdd915fdae612651e7a806d">transcoder_read</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, char *buff, size_t offset, size_t len, int *bytes_read)</td></tr>
<tr class="memdesc:aa956e0359fdd915fdae612651e7a806d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read some bytes into the internal buffer and into the given buffer.  <a href="#aa956e0359fdd915fdae612651e7a806d">More...</a><br /></td></tr>
<tr class="separator:aa956e0359fdd915fdae612651e7a806d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa40f1d11c536c0267ff99aa7f2900c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#afa40f1d11c536c0267ff99aa7f2900c6">transcoder_delete</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry)</td></tr>
<tr class="memdesc:afa40f1d11c536c0267ff99aa7f2900c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free the cache entry structure.  <a href="#afa40f1d11c536c0267ff99aa7f2900c6">More...</a><br /></td></tr>
<tr class="separator:afa40f1d11c536c0267ff99aa7f2900c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d36e6c898b599099ee24f3bc6b7585"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aa5d36e6c898b599099ee24f3bc6b7585">transcoder_get_size</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry)</td></tr>
<tr class="memdesc:aa5d36e6c898b599099ee24f3bc6b7585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return size of output file, as computed by encoder.  <a href="#aa5d36e6c898b599099ee24f3bc6b7585">More...</a><br /></td></tr>
<tr class="separator:aa5d36e6c898b599099ee24f3bc6b7585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af845f89460b7909a7bbdbfcc982cc6f9"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#af845f89460b7909a7bbdbfcc982cc6f9">transcoder_buffer_watermark</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry)</td></tr>
<tr class="memdesc:af845f89460b7909a7bbdbfcc982cc6f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current watermark of the file while transcoding.  <a href="#af845f89460b7909a7bbdbfcc982cc6f9">More...</a><br /></td></tr>
<tr class="separator:af845f89460b7909a7bbdbfcc982cc6f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9406f4689c8aaff6ac26867408a74b15"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a9406f4689c8aaff6ac26867408a74b15">transcoder_buffer_tell</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry)</td></tr>
<tr class="memdesc:a9406f4689c8aaff6ac26867408a74b15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current file position in the file.  <a href="#a9406f4689c8aaff6ac26867408a74b15">More...</a><br /></td></tr>
<tr class="separator:a9406f4689c8aaff6ac26867408a74b15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0ba8fb3f638410a3d64a2488661713c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#af0ba8fb3f638410a3d64a2488661713c">transcoder_exit</a> (void)</td></tr>
<tr class="memdesc:af0ba8fb3f638410a3d64a2488661713c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exit transcoding.  <a href="#af0ba8fb3f638410a3d64a2488661713c">More...</a><br /></td></tr>
<tr class="separator:af0ba8fb3f638410a3d64a2488661713c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138350f4248a6dfa3afe5eee6b63d24d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a138350f4248a6dfa3afe5eee6b63d24d">transcoder_cache_maintenance</a> (void)</td></tr>
<tr class="memdesc:a138350f4248a6dfa3afe5eee6b63d24d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run cache maintenance.  <a href="#a138350f4248a6dfa3afe5eee6b63d24d">More...</a><br /></td></tr>
<tr class="separator:a138350f4248a6dfa3afe5eee6b63d24d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96abbfc5e99e5a00673182237b58a7b0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a96abbfc5e99e5a00673182237b58a7b0">transcoder_cache_clear</a> (void)</td></tr>
<tr class="memdesc:a96abbfc5e99e5a00673182237b58a7b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear transcoder cache.  <a href="#a96abbfc5e99e5a00673182237b58a7b0">More...</a><br /></td></tr>
<tr class="separator:a96abbfc5e99e5a00673182237b58a7b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9769c6d320fbff3c0a1af3a2dac24e70"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a9769c6d320fbff3c0a1af3a2dac24e70">init_logging</a> (const std::string &amp;logfile, const std::string &amp;max_level, bool to_stderr, bool to_syslog)</td></tr>
<tr class="memdesc:a9769c6d320fbff3c0a1af3a2dac24e70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inititalise logging facility.  <a href="#a9769c6d320fbff3c0a1af3a2dac24e70">More...</a><br /></td></tr>
<tr class="separator:a9769c6d320fbff3c0a1af3a2dac24e70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a219405a7efb1068433bdef1efa916e8a"><td class="memItemLeft" align="right" valign="top"><a id="a219405a7efb1068433bdef1efa916e8a"></a>
static <a class="el" href="classCache.html">Cache</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a219405a7efb1068433bdef1efa916e8a">cache</a></td></tr>
<tr class="memdesc:a219405a7efb1068433bdef1efa916e8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global cache manager object. <br /></td></tr>
<tr class="separator:a219405a7efb1068433bdef1efa916e8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab27c735ddd0160ff2541829f9ecf7071"><td class="memItemLeft" align="right" valign="top"><a id="ab27c735ddd0160ff2541829f9ecf7071"></a>
static volatile bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#ab27c735ddd0160ff2541829f9ecf7071">thread_exit</a></td></tr>
<tr class="memdesc:ab27c735ddd0160ff2541829f9ecf7071"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used for shutdown: if true, exit all thread. <br /></td></tr>
<tr class="separator:ab27c735ddd0160ff2541829f9ecf7071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e61ecf91e254a28de060d8105cbcf0"><td class="memItemLeft" align="right" valign="top"><a id="a20e61ecf91e254a28de060d8105cbcf0"></a>
static volatile unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a20e61ecf91e254a28de060d8105cbcf0">thread_count</a></td></tr>
<tr class="memdesc:a20e61ecf91e254a28de060d8105cbcf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of currently active threads. <br /></td></tr>
<tr class="separator:a20e61ecf91e254a28de060d8105cbcf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>File transcoder interface implementation. </p>
<dl class="section author"><dt>Author</dt><dd>Norbert Schlia (<a href="#" onclick="location.href='mai'+'lto:'+'nsc'+'hl'+'ia@'+'ob'+'liv'+'io'+'n-s'+'of'+'twa'+'re'+'.de'; return false;">nschl<span style="display: none;">.nosp@m.</span>ia@o<span style="display: none;">.nosp@m.</span>blivi<span style="display: none;">.nosp@m.</span>on-s<span style="display: none;">.nosp@m.</span>oftwa<span style="display: none;">.nosp@m.</span>re.d<span style="display: none;">.nosp@m.</span>e</a>) </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (C) 2006-2008 David Collett <br />
Copyright (C) 2008-2013 K. Henriksson <br />
Copyright (C) 2017-2019 FFmpeg support by Norbert Schlia (<a href="#" onclick="location.href='mai'+'lto:'+'nsc'+'hl'+'ia@'+'ob'+'liv'+'io'+'n-s'+'of'+'twa'+'re'+'.de'; return false;">nschl<span style="display: none;">.nosp@m.</span>ia@o<span style="display: none;">.nosp@m.</span>blivi<span style="display: none;">.nosp@m.</span>on-s<span style="display: none;">.nosp@m.</span>oftwa<span style="display: none;">.nosp@m.</span>re.d<span style="display: none;">.nosp@m.</span>e</a>) </dd></dl>

<p class="definition">Definition in file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9769c6d320fbff3c0a1af3a2dac24e70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9769c6d320fbff3c0a1af3a2dac24e70">&#9670;&nbsp;</a></span>init_logging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool init_logging </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>max_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>to_stderr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>to_syslog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inititalise logging facility. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">logfile</td><td>- Name of log file if file writing is selected. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_level</td><td>- Maximum level to log. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to_stderr</td><td>- If true, log to stderr. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to_syslog</td><td>- If true, log to syslog. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success; false on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00917">917</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="logging_8h_source.html#l00371">DEBUG</a>, <a class="el" href="logging_8h_source.html#l00368">ERROR</a>, <a class="el" href="logging_8h_source.html#l00370">INFO</a>, <a class="el" href="logging_8cc_source.html#l00171">Logging::init_logging()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00359">level_map</a>, <a class="el" href="logging_8h_source.html#l00372">TRACE</a>, and <a class="el" href="logging_8h_source.html#l00369">WARNING</a>.</p>

<p class="reference">Referenced by <a class="el" href="ffmpegfs_8cc_source.html#l01252">main()</a>.</p>

</div>
</div>
<a id="a33f5c5e32ae960358957e09353f15236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33f5c5e32ae960358957e09353f15236">&#9670;&nbsp;</a></span>transcode_finish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int transcode_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFFmpeg__Transcoder.html">FFmpeg_Transcoder</a> *&#160;</td>
          <td class="paramname"><em>transcoder</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close the input file and free everything but the initial buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transcoder</td><td>- Current <a class="el" href="classFFmpeg__Transcoder.html" title="The FFmpeg_Transcoder class. ">FFmpeg_Transcoder</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success returns 0; on error negative AVERROR. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00126">126</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="buffer_8cc_source.html#l00425">Buffer::buffer_watermark()</a>, <a class="el" href="logging_8h_source.html#l00179">Logging::debug()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l04026">FFmpeg_Transcoder::destname()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03685">FFmpeg_Transcoder::encode_finish()</a>, <a class="el" href="cache__entry_8cc_source.html#l00264">Cache_Entry::flush()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00971">format_result_size_ex()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00952">format_size_ex()</a>, <a class="el" href="cache_8h_source.html#l00055">CACHE_INFO::m_averror</a>, <a class="el" href="cache__entry_8h_source.html#l00211">Cache_Entry::m_buffer</a>, <a class="el" href="cache__entry_8h_source.html#l00215">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00051">CACHE_INFO::m_encoded_filesize</a>, <a class="el" href="cache_8h_source.html#l00054">CACHE_INFO::m_errno</a>, <a class="el" href="cache_8h_source.html#l00052">CACHE_INFO::m_finished</a>, <a class="el" href="cache__entry_8h_source.html#l00212">Cache_Entry::m_is_decoding</a>, <a class="el" href="cache_8h_source.html#l00050">CACHE_INFO::m_predicted_filesize</a>, and <a class="el" href="buffer_8cc_source.html#l00282">Buffer::reserve()</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00651">transcoder_thread()</a>.</p>

</div>
</div>
<a id="aeaf3471620b6ae9269795e339cf68243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaf3471620b6ae9269795e339cf68243">&#9670;&nbsp;</a></span>transcode_until()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool transcode_until </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transcode the buffer until the buffer has enough or until an error occurs. The buffer needs at least 'end' bytes before transcoding stops. Returns true if no errors and false otherwise. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">offset</td><td>- byte offset to start reading at </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>- length of data chunk to be read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns true. Returns false if an error occurred. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00075">75</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache__entry_8cc_source.html#l00329">Cache_Entry::destname()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00952">format_size_ex()</a>, <a class="el" href="logging_8h_source.html#l00202">Logging::info()</a>, <a class="el" href="cache__entry_8h_source.html#l00211">Cache_Entry::m_buffer</a>, <a class="el" href="cache__entry_8h_source.html#l00215">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00053">CACHE_INFO::m_error</a>, <a class="el" href="cache_8h_source.html#l00052">CACHE_INFO::m_finished</a>, <a class="el" href="cache__entry_8h_source.html#l00212">Cache_Entry::m_is_decoding</a>, <a class="el" href="buffer_8cc_source.html#l00420">Buffer::size()</a>, <a class="el" href="buffer_8cc_source.html#l00410">Buffer::tell()</a>, <a class="el" href="transcode_8cc_source.html#l00055">thread_exit</a>, <a class="el" href="logging_8h_source.html#l00156">Logging::trace()</a>, and <a class="el" href="logging_8h_source.html#l00225">Logging::warning()</a>.</p>

</div>
</div>
<a id="a9406f4689c8aaff6ac26867408a74b15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9406f4689c8aaff6ac26867408a74b15">&#9670;&nbsp;</a></span>transcoder_buffer_tell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t transcoder_buffer_tell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the current file position in the file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the current file position </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00612">612</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache__entry_8h_source.html#l00211">Cache_Entry::m_buffer</a>, and <a class="el" href="buffer_8cc_source.html#l00410">Buffer::tell()</a>.</p>

</div>
</div>
<a id="af845f89460b7909a7bbdbfcc982cc6f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af845f89460b7909a7bbdbfcc982cc6f9">&#9670;&nbsp;</a></span>transcoder_buffer_watermark()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t transcoder_buffer_watermark </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the current watermark of the file while transcoding. </p>
<p>While transcoding, this value reflects the current size of the transcoded file. This is the maximum byte offset until the file can be read so far.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the current watermark </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00607">607</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="buffer_8cc_source.html#l00425">Buffer::buffer_watermark()</a>, and <a class="el" href="cache__entry_8h_source.html#l00211">Cache_Entry::m_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00717">ffmpegfs_fgetattr()</a>.</p>

</div>
</div>
<a id="a96abbfc5e99e5a00673182237b58a7b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96abbfc5e99e5a00673182237b58a7b0">&#9670;&nbsp;</a></span>transcoder_cache_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_cache_clear </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear transcoder cache. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success; false on error. Check errno for details. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00634">634</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache_8cc_source.html#l00786">Cache::clear()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ffmpegfs_8cc_source.html#l01252">main()</a>.</p>

</div>
</div>
<a id="a138350f4248a6dfa3afe5eee6b63d24d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a138350f4248a6dfa3afe5eee6b63d24d">&#9670;&nbsp;</a></span>transcoder_cache_maintenance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_cache_maintenance </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run cache maintenance. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success; false on error. Check errno for details. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00622">622</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache_8cc_source.html#l00770">Cache::maintenance()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ffmpegfs_8cc_source.html#l01252">main()</a>, and <a class="el" href="cache__maintenance_8cc_source.html#l00065">maintenance_handler()</a>.</p>

</div>
</div>
<a id="ac10788fe59c0d275e077c89d7af43b3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac10788fe59c0d275e077c89d7af43b3e">&#9670;&nbsp;</a></span>transcoder_cache_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transcoder_cache_path </td>
          <td>(</td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get transcoder cache path. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">path</td><td>- Path to transcoder cache. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00159">159</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="ffmpeg__utils_8cc_source.html#l00219">append_sep()</a>, <a class="el" href="ffmpegfs_8h_source.html#l00155">FFMPEGFS_PARAMS::m_cachepath</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00075">params</a>, and <a class="el" href="ffmpeg__utils_8cc_source.html#l00627">tempdir()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cache_8cc_source.html#l00072">Cache::load_index()</a>, <a class="el" href="buffer_8cc_source.html#l00486">Buffer::make_cachefile_name()</a>, and <a class="el" href="ffmpegfs_8cc_source.html#l01149">print_params()</a>.</p>

</div>
</div>
<a id="aeaf746244e3f08933d0c1ed855915207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaf746244e3f08933d0c1ed855915207">&#9670;&nbsp;</a></span>transcoder_cached_filesize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_cached_filesize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *&#160;</td>
          <td class="paramname"><em>stbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simply get encoded file size (do not create the whole encoder/decoder objects) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">virtualfile</td><td>- virtual file object to open </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stbuf</td><td>- stat struct filled in with the size of the cached file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if file was found in cache, false if not (stbuf will be unchanged) </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00211">211</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache__entry_8cc_source.html#l00329">Cache_Entry::destname()</a>, <a class="el" href="cache__entry_8h_source.html#l00215">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00051">CACHE_INFO::m_encoded_filesize</a>, <a class="el" href="cache_8h_source.html#l00050">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="cache_8cc_source.html#l00496">Cache::open()</a>, and <a class="el" href="logging_8h_source.html#l00156">Logging::trace()</a>.</p>

<p class="reference">Referenced by <a class="el" href="blurayparser_8cc_source.html#l00320">create_bluray_virtualfile()</a>, <a class="el" href="dvdparser_8cc_source.html#l00241">create_dvd_virtualfile()</a>, and <a class="el" href="fuseops_8cc_source.html#l00561">ffmpegfs_getattr()</a>.</p>

</div>
</div>
<a id="afa40f1d11c536c0267ff99aa7f2900c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa40f1d11c536c0267ff99aa7f2900c6">&#9670;&nbsp;</a></span>transcoder_delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transcoder_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free the cache entry structure. </p>
<p>Call this to free the cache entry structure. <br />
The structure is reference counted, after calling this function, if the cache entry is not use by another thread, the cache entry may no longer be valid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00597">597</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache_8cc_source.html#l00515">Cache::close()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00561">ffmpegfs_getattr()</a>, and <a class="el" href="fuseops_8cc_source.html#l01049">ffmpegfs_release()</a>.</p>

</div>
</div>
<a id="af0ba8fb3f638410a3d64a2488661713c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0ba8fb3f638410a3d64a2488661713c">&#9670;&nbsp;</a></span>transcoder_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transcoder_exit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exit transcoding. </p>
<p>Send signal to exit transcoding (ending all transcoder threads). </p>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00617">617</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00055">thread_exit</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l01131">ffmpegfs_destroy()</a>, and <a class="el" href="fuseops_8cc_source.html#l01072">sighandler()</a>.</p>

</div>
</div>
<a id="aa5d36e6c898b599099ee24f3bc6b7585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d36e6c898b599099ee24f3bc6b7585">&#9670;&nbsp;</a></span>transcoder_get_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t transcoder_get_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return size of output file, as computed by encoder. </p>
<p>Returns the file size, either the predicted size (which may be inaccurate) or the real size (which is only available once the file was completely recoded).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the file. Function never fails. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00602">602</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache__entry_8cc_source.html#l00278">Cache_Entry::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00561">ffmpegfs_getattr()</a>.</p>

</div>
</div>
<a id="aa46f3dfbc96faf285238b7804e0525a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46f3dfbc96faf285238b7804e0525a6">&#9670;&nbsp;</a></span>transcoder_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise transcoder, create cache. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success; false on error. Check errno for details. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00177">177</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="logging_8h_source.html#l00179">Logging::debug()</a>, <a class="el" href="logging_8h_source.html#l00248">Logging::error()</a>, and <a class="el" href="cache_8cc_source.html#l00072">Cache::load_index()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ffmpegfs_8cc_source.html#l01252">main()</a>.</p>

</div>
</div>
<a id="ace38421aa8da8b23852109db4b0f1c95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace38421aa8da8b23852109db4b0f1c95">&#9670;&nbsp;</a></span>transcoder_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCache__Entry.html">Cache_Entry</a>* transcoder_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>begin_transcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate and initialise the transcoder. </p>
<p>Opens a file and starts the decoding thread if begin_transcode is true. File will be scanned to detect bit rate, duration etc. only if begin_transcode is false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">virtualfile</td><td>- virtual file object to open </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">begin_transcode</td><td>- if true, transcoding starts, if false file will be scanned only </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns cache entry object. On error, returns nullptr and sets errno accordingly. </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>Perils of the sun: If started in detached state, threads cannot be joined. Not starting in detached state creates a tiny little memory leak. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00303">303</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache__entry_8cc_source.html#l00101">Cache_Entry::clear()</a>, <a class="el" href="cache_8cc_source.html#l00515">Cache::close()</a>, <a class="el" href="buffer_8h_source.html#l00041">CLOSE_CACHE_DELETE</a>, <a class="el" href="logging_8h_source.html#l00179">Logging::debug()</a>, <a class="el" href="cache__entry_8cc_source.html#l00329">Cache_Entry::destname()</a>, <a class="el" href="logging_8h_source.html#l00248">Logging::error()</a>, <a class="el" href="cache__entry_8cc_source.html#l00324">Cache_Entry::filename()</a>, <a class="el" href="logging_8h_source.html#l00202">Logging::info()</a>, <a class="el" href="cache__entry_8cc_source.html#l00334">Cache_Entry::lock()</a>, <a class="el" href="transcode_8cc_source.html#l00051">THREAD_DATA::m_arg</a>, <a class="el" href="cache__entry_8h_source.html#l00215">Cache_Entry::m_cache_info</a>, <a class="el" href="transcode_8cc_source.html#l00049">THREAD_DATA::m_cond</a>, <a class="el" href="ffmpegfs_8h_source.html#l00156">FFMPEGFS_PARAMS::m_disable_cache</a>, <a class="el" href="cache_8h_source.html#l00054">CACHE_INFO::m_errno</a>, <a class="el" href="cache_8h_source.html#l00053">CACHE_INFO::m_error</a>, <a class="el" href="cache_8h_source.html#l00052">CACHE_INFO::m_finished</a>, <a class="el" href="transcode_8cc_source.html#l00050">THREAD_DATA::m_initialised</a>, <a class="el" href="cache__entry_8h_source.html#l00212">Cache_Entry::m_is_decoding</a>, <a class="el" href="ffmpegfs_8h_source.html#l00160">FFMPEGFS_PARAMS::m_max_threads</a>, <a class="el" href="transcode_8cc_source.html#l00048">THREAD_DATA::m_mutex</a>, <a class="el" href="cache_8h_source.html#l00050">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="cache__entry_8h_source.html#l00213">Cache_Entry::m_thread_id</a>, <a class="el" href="cache__entry_8cc_source.html#l00179">Cache_Entry::open()</a>, <a class="el" href="cache_8cc_source.html#l00496">Cache::open()</a>, <a class="el" href="cache__entry_8cc_source.html#l00349">Cache_Entry::outdated()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00075">params</a>, <a class="el" href="transcode_8cc_source.html#l00056">thread_count</a>, <a class="el" href="transcode_8cc_source.html#l00055">thread_exit</a>, <a class="el" href="logging_8h_source.html#l00156">Logging::trace()</a>, <a class="el" href="transcode_8cc_source.html#l00276">transcoder_predict_filesize()</a>, <a class="el" href="transcode_8cc_source.html#l00651">transcoder_thread()</a>, <a class="el" href="cache__entry_8cc_source.html#l00339">Cache_Entry::unlock()</a>, and <a class="el" href="logging_8h_source.html#l00225">Logging::warning()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00561">ffmpegfs_getattr()</a>, and <a class="el" href="fuseops_8cc_source.html#l00820">ffmpegfs_open()</a>.</p>

</div>
</div>
<a id="a318fb7fd8dac4f1ab7b350972962b89f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a318fb7fd8dac4f1ab7b350972962b89f">&#9670;&nbsp;</a></span>transcoder_predict_filesize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_predict_filesize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predict file size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">virtualfile</td><td>- virtual file object to open </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On error, returns false (size could not be predicted) or true on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00276">276</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03799">FFmpeg_Transcoder::close()</a>, <a class="el" href="logging_8h_source.html#l00179">Logging::debug()</a>, <a class="el" href="logging_8h_source.html#l00248">Logging::error()</a>, <a class="el" href="cache__entry_8cc_source.html#l00324">Cache_Entry::filename()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00952">format_size_ex()</a>, <a class="el" href="cache__entry_8h_source.html#l00215">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00050">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l00236">FFmpeg_Transcoder::open_input_file()</a>, and <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03680">FFmpeg_Transcoder::predicted_filesize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00303">transcoder_new()</a>.</p>

</div>
</div>
<a id="aa956e0359fdd915fdae612651e7a806d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa956e0359fdd915fdae612651e7a806d">&#9670;&nbsp;</a></span>transcoder_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read some bytes into the internal buffer and into the given buffer. </p>
<dl class="section note"><dt>Note</dt><dd>buff must be large enough to hold len number of bytes. </dd>
<dd>
Returns number of bytes read, may be less than len bytes. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buff</td><td>- will be filled in with data read </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">offset</td><td>- byte offset to start reading at </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>- length of data chunk to be read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bytes_read</td><td>- Bytes read from transcoder. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns number of bytes read. On error, returns -1 and sets errno accordingly. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00489">489</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="ffmpegfs_8cc_source.html#l00162">FFMPEGFS_PARAMS::current_format()</a>, <a class="el" href="cache__entry_8cc_source.html#l00329">Cache_Entry::destname()</a>, <a class="el" href="cache__entry_8h_source.html#l00215">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00052">CACHE_INFO::m_finished</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00075">params</a>, <a class="el" href="logging_8h_source.html#l00156">Logging::trace()</a>, <a class="el" href="cache__entry_8cc_source.html#l00165">Cache_Entry::update_access()</a>, <a class="el" href="cache__entry_8cc_source.html#l00409">Cache_Entry::update_read_count()</a>, and <a class="el" href="cache__entry_8cc_source.html#l00404">Cache_Entry::virtualfile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00908">ffmpegfs_read()</a>.</p>

</div>
</div>
<a id="ab5d7c75585d5efc898826b2f3bf9bc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d7c75585d5efc898826b2f3bf9bc4b">&#9670;&nbsp;</a></span>transcoder_set_filesize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_set_filesize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__utils_8h.html#a17468d10f0c67a4ee7b38aab09d9e096">BITRATE</a>&#160;</td>
          <td class="paramname"><em>audio_bit_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>channels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sample_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__utils_8h.html#a17468d10f0c67a4ee7b38aab09d9e096">BITRATE</a>&#160;</td>
          <td class="paramname"><em>video_bit_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interleaved</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const AVRational &amp;&#160;</td>
          <td class="paramname"><em>framerate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">virtualfile</td><td>- virtual file object to open. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">duration</td><td>- duration of the file, in AV_TIME_BASE fractional seconds. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">audio_bit_rate</td><td>- average bitrate of audio data (in bits per second). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">channels</td><td>- number of channels (1: mono, 2: stereo, or more). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sample_rate</td><td>- number of audio samples per second. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">video_bit_rate</td><td>- average bitrate of video data (in bits per second). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">width</td><td>- video width in pixels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">height</td><td>- video height in pixels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interleaved</td><td>- 1 if video is interleaved, 0 if not. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">framerate</td><td>- frame rate per second (e.g. 24, 25, 30...). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On error, returns false (size could not be set) or true on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00241">241</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="ffmpeg__utils_8cc_source.html#l00214">FFmpegfs_Format::audio_codec_id()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03484">FFmpeg_Transcoder::audio_size()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00162">FFMPEGFS_PARAMS::current_format()</a>, <a class="el" href="logging_8h_source.html#l00179">Logging::debug()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00194">FFmpegfs_Format::desttype()</a>, <a class="el" href="logging_8h_source.html#l00248">Logging::error()</a>, <a class="el" href="cache__entry_8cc_source.html#l00324">Cache_Entry::filename()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00952">format_size_ex()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00564">get_codec_name()</a>, <a class="el" href="cache__entry_8h_source.html#l00215">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00050">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="cache_8cc_source.html#l00496">Cache::open()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00075">params</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00209">FFmpegfs_Format::video_codec_id()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03555">FFmpeg_Transcoder::video_size()</a>, and <a class="el" href="logging_8h_source.html#l00225">Logging::warning()</a>.</p>

<p class="reference">Referenced by <a class="el" href="blurayparser_8cc_source.html#l00320">create_bluray_virtualfile()</a>, and <a class="el" href="dvdparser_8cc_source.html#l00241">create_dvd_virtualfile()</a>.</p>

</div>
</div>
<a id="a1a7bc5add7ffb809dc77dc18427c34c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a7bc5add7ffb809dc77dc18427c34c2">&#9670;&nbsp;</a></span>transcoder_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * transcoder_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transcoding thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>- Corresponding <a class="el" href="classCache__Entry.html" title="The Cache_Entry class. ">Cache_Entry</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns nullptr. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00651">651</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="buffer_8cc_source.html#l00425">Buffer::buffer_watermark()</a>, <a class="el" href="cache_8cc_source.html#l00515">Cache::close()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03799">FFmpeg_Transcoder::close()</a>, <a class="el" href="buffer_8h_source.html#l00041">CLOSE_CACHE_DELETE</a>, <a class="el" href="buffer_8h_source.html#l00039">CLOSE_CACHE_NOOPT</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00162">FFMPEGFS_PARAMS::current_format()</a>, <a class="el" href="logging_8h_source.html#l00179">Logging::debug()</a>, <a class="el" href="logging_8h_source.html#l00371">DEBUG</a>, <a class="el" href="cache__entry_8cc_source.html#l00319">Cache_Entry::decode_timeout()</a>, <a class="el" href="cache__entry_8cc_source.html#l00329">Cache_Entry::destname()</a>, <a class="el" href="logging_8h_source.html#l00248">Logging::error()</a>, <a class="el" href="logging_8h_source.html#l00368">ERROR</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00355">ffmpeg_geterror()</a>, <a class="el" href="cache__entry_8cc_source.html#l00324">Cache_Entry::filename()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00952">format_size_ex()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03699">FFmpeg_Transcoder::id3v1tag()</a>, <a class="el" href="logging_8h_source.html#l00202">Logging::info()</a>, <a class="el" href="logging_8cc_source.html#l00181">Logging::log_with_level()</a>, <a class="el" href="transcode_8cc_source.html#l00051">THREAD_DATA::m_arg</a>, <a class="el" href="cache_8h_source.html#l00055">CACHE_INFO::m_averror</a>, <a class="el" href="cache__entry_8h_source.html#l00211">Cache_Entry::m_buffer</a>, <a class="el" href="cache__entry_8h_source.html#l00215">Cache_Entry::m_cache_info</a>, <a class="el" href="transcode_8cc_source.html#l00049">THREAD_DATA::m_cond</a>, <a class="el" href="cache_8h_source.html#l00054">CACHE_INFO::m_errno</a>, <a class="el" href="cache_8h_source.html#l00053">CACHE_INFO::m_error</a>, <a class="el" href="cache_8h_source.html#l00052">CACHE_INFO::m_finished</a>, <a class="el" href="cache__entry_8h_source.html#l00217">Cache_Entry::m_id3v1</a>, <a class="el" href="transcode_8cc_source.html#l00050">THREAD_DATA::m_initialised</a>, <a class="el" href="cache__entry_8h_source.html#l00212">Cache_Entry::m_is_decoding</a>, <a class="el" href="ffmpegfs_8h_source.html#l00151">FFMPEGFS_PARAMS::m_max_inactive_abort</a>, <a class="el" href="ffmpegfs_8h_source.html#l00150">FFMPEGFS_PARAMS::m_max_inactive_suspend</a>, <a class="el" href="ffmpegfs_8h_source.html#l00152">FFMPEGFS_PARAMS::m_prebuffer_size</a>, <a class="el" href="cache_8h_source.html#l00050">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="cache__entry_8h_source.html#l00213">Cache_Entry::m_thread_id</a>, <a class="el" href="cache_8cc_source.html#l00770">Cache::maintenance()</a>, <a class="el" href="cache__entry_8cc_source.html#l00179">Cache_Entry::open()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l00236">FFmpeg_Transcoder::open_input_file()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l00606">FFmpeg_Transcoder::open_output_file()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00075">params</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03680">FFmpeg_Transcoder::predicted_filesize()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l03221">FFmpeg_Transcoder::process_single_fr()</a>, <a class="el" href="cache__entry_8cc_source.html#l00344">Cache_Entry::ref_count()</a>, <a class="el" href="cache__entry_8cc_source.html#l00314">Cache_Entry::suspend_timeout()</a>, <a class="el" href="transcode_8cc_source.html#l00056">thread_count</a>, <a class="el" href="transcode_8cc_source.html#l00055">thread_exit</a>, <a class="el" href="logging_8h_source.html#l00372">TRACE</a>, <a class="el" href="transcode_8cc_source.html#l00126">transcode_finish()</a>, <a class="el" href="cache__entry_8cc_source.html#l00165">Cache_Entry::update_access()</a>, <a class="el" href="cache__entry_8cc_source.html#l00404">Cache_Entry::virtualfile()</a>, <a class="el" href="logging_8h_source.html#l00225">Logging::warning()</a>, and <a class="el" href="logging_8h_source.html#l00369">WARNING</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00303">transcoder_new()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
